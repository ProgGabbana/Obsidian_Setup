/*
    Source: https://github.com/SlRvb/Obsidian--ITS-Theme/blob/main/Snippets/S%20-%20Images%20Adjustments.css
*/

body {
    /* Variabili di dimensione per le immagini (valori assoluti) */
    --s: 200px;  /* Corrisponde alla vecchia 'small' */
    --m: 300px;  /* NUOVA dimensione intermedia */
    --l: 400px;  /* Corrisponde alla vecchia 'medium' */
    --xl: 600px; /* Corrisponde alla vecchia 'full' */
}

.popover.hover-popover {
    --s: 200px;
    --m: 300px;
    --l: 400px;
    --xl: 600px;
}

/* ---------------------------------------------------------------------- */
/* NUOVI SELETTORI - Applicano SOLO la larghezza (width) - Non ci sono h-tags */
/* ---------------------------------------------------------------------- */

/* Modifica i selettori: usa solo s, m, l, xl (senza 'w' o 'h') */
.view-content  img[alt]:is([alt*=s],
[alt*=m],
[alt*=l],
[alt*=xl]) {
    width: var(--image-adj-size);
    /* L'altezza viene rimossa o lasciata su 'auto' per mantenere le proporzioni */
    height: auto;
}

/* Regole per la dimensione - Nuove dimensioni (alt text) */
.view-content img[alt][alt*=s] {
    --image-adj-size: var(--s);
}
.view-content img[alt][alt*=m] {
    --image-adj-size: var(--m);
}
.view-content img[alt][alt*=l] {
    --image-adj-size: var(--l);
}
.view-content img[alt][alt*=xl] {
    --image-adj-size: var(--xl);
}
/* Se si vuole usare 'xl' per il 100% della larghezza del contenitore: */
/* .view-content img[alt][alt*=xl] { --image-adj-size: 100%; } */


.image-embed,
div:not(.image-embed) > img {
    display: block;
    margin: auto;
    max-height: 100%;
}

/* ... (Regole locl/locr rimangono invariate) ... */
.markdown-rendered img[alt~=locl],
.markdown-rendered img[src*="#locl"],
.markdown-rendered .image-embed[alt~=locl],
.markdown-rendered .image-embed[src*="#locl"] {
    float: inline-start;
    margin-right: 2%;
    margin-top: 0;
    margin-bottom: 0;
}

img[alt~=locl],
.image-embed[alt~=locl],
img[src*="#locl"],
.image-embed[src*="#locl"] {
    float: left ;
    margin-right: 2%;
    margin-top: 0;
    margin-bottom: 0;
}


.markdown-rendered img[alt~=locr],
.markdown-rendered img[src*="#locr"],
.markdown-rendered .image-embed[alt~=locr],
.markdown-rendered .image-embed[src*="#locr"] {
    float: inline-end;
    margin-left: 2%;
    margin-bottom: 0;
    margin-top: 0;
}

img[alt~=locr],
.image-embed[alt~=locr],
img[src*="#locr"],
.image-embed[src*="#locr"] {
    float: right ;
    margin-left: 2%;
    margin-bottom: 0;
    margin-top: 0;
}

/* ---------------------------------------------------------------------- */
/* REGOLE PER MOSTRARE LA CAPTION SOTTO L'IMMAGINE ALL'HOVER */
/* ---------------------------------------------------------------------- */

.image-embed[src*="#cap"]::after {
    content: attr(alt);
    display: none;
    text-align: center;
    padding: 5px 0;
    font-size: 0.85em;
    color: var(--text-muted);
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.3s ease-in-out;
}

.image-embed[src*="#cap"]:hover::after {
    display: block;
    opacity: 1;
}

.image-embed[src*="#cap"] {
    display: inline-block;
    position: relative;
}

.image-embed[src*="#cap"] img {
    float: unset ;
}

/* Regole per didascalie (solo larghezza) - Nuove dimensioni (src hash) */
/* Applichiamo la dimensione al contenitore e all'immagine interna. */
/* NOTA: Abbiamo rimosso i selettori [src*="#h..."] e [src*="#w..."] */
.image-embed[src*="#cap"][src*="#s"], .image-embed[src*="#cap"][src*="#s"] img {
    width: var(--s);
    height: auto;
}
.image-embed[src*="#cap"][src*="#m"], .image-embed[src*="#cap"][src*="#m"] img {
    width: var(--m);
    height: auto;
}
.image-embed[src*="#cap"][src*="#l"], .image-embed[src*="#cap"][src*="#l"] img {
    width: var(--l);
    height: auto;
}
.image-embed[src*="#cap"][src*="#xl"], .image-embed[src*="#cap"][src*="#xl"] img {
    width: var(--xl);
    height: auto;
}
/* Se si vuole usare 'xl' per il 100% della larghezza del contenitore: */
/* .image-embed[src*="#cap"][src*="#xl"], .image-embed[src*="#cap"][src*="#xl"] img { width: 100%; height: auto; } */


.mobile-image-viewer img[alt] {
    height: 100%;
    width: 100%;
    object-fit: contain;
}

/* ... (Regole per lo Zoom rimangono invariate) ... */
.view-content img {
    max-width: 100%;
    cursor: zoom-in;
}

.view-content img:active {
    cursor: zoom-out;
}

.view-content .markdown-preview-view img[referrerpolicy="no-referrer"]:active,
.view-content .image-embed:active {
    background: var(--background-primary);
    cursor: zoom-out;
    display: block;
    z-index: 200;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    height: 100%;
    width: 100%;
    max-height: 100%;
    max-width: 100%;
    object-fit: contain;
    margin: 0 auto;
    text-align: center;
    padding: 0;
}

.image-embed[src*="#cap"]:active::after {
    display: none;
    opacity: 0;
}

.view-content .image-embed:active img {
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    padding: 0;
    margin: 0;
    width: 50vw;
    height: 50vh;
    max-height: 50vh;
    max-width: 50vw;
    object-fit: contain;
    position: fixed;
    opacity: 1;
    z-index: 201;
}
